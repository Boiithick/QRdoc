<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel - Create Cards</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f2f2f2;
      padding: 40px;
      text-align: center;
    }
    .container {
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      display: inline-block;
    }
    input, button {
      display: block;
      margin: 10px auto;
      padding: 10px;
      width: 80%;
      max-width: 400px;
    }
    #qrcode {
      margin-top: 20px;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
</head>
<body>
  <div class="container">
    <h2>Create a New Card</h2>
    <input type="text" id="a1" placeholder="Answer 1 (Correct)">
    <input type="text" id="a2" placeholder="Answer 2 (Wrong)">
    <input type="text" id="a3" placeholder="Answer 3 (Wrong)">
    <button onclick="createCard()">Generate Link & QR Code</button>

    <div id="linkOutput"></div>
    <canvas id="qrcode"></canvas>
  </div>

  <script>
    function generateEncodedGameLink(cardData) {
      const { a1, a2, a3 } = cardData;
      const query = new URLSearchParams({ a1, a2, a3 }).toString();
      const encoded = btoa(query);
      return `game.html?data=${encoded}`;
    }

    function createCard() {
      const a1 = document.getElementById("a1").value;
      const a2 = document.getElementById("a2").value;
      const a3 = document.getElementById("a3").value;

      if (!a1 || !a2 || !a3) {
        alert("Please fill in all three answers.");
        return;
      }

      const url = generateEncodedGameLink({ a1, a2, a3 });
      const fullUrl = window.location.origin + "/" + url;

      document.getElementById("linkOutput").innerHTML = `
        <p><strong>Game Link:</strong> <a href="${url}" target="_blank">${fullUrl}</a></p>
      `;

      // Generate QR code
      QRCode.toCanvas(document.getElementById('qrcode'), fullUrl, function (error) {
        if (error) console.error(error);
        console.log('QR code generated!');
      });
    }
  </script>
</body>
</html>
